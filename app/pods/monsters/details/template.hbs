{{#liquid-bind model use='offset-fade' class='liquid-main' enableGrowth=false as |currentModel|}}
  <form {{action (route-action 'save') on='submit'}} class="constrained traditional">
    <header>
      <h1>{{currentModel.name}}</h1>
      <span class="spacer"></span>
      <button class="button danger" {{action (toggle-action 'showDeleteConfirmationModal' this)}}>Delete</button>
      {{#link-to 'monsters.index' classNames='button'}}Cancel{{/link-to}}
      <button type="submit" class="button primary">Save</button>
    </header>
    <div class="columns">
      <div class="column">
        <p>
          {{input id=(concat currentModel.id '_name') value=currentModel.rename}}
          <label for="{{currentModel.id}}_name">Name</label>
        </p>
        <p style="width: calc(50% - 1.0rem)">
          {{input id=(concat currentModel.id '_hitPoints') value=currentModel.hitPoints type='number'}}
          <label for="{{currentModel.id}}_hitPoints">Hit Points</label>
        </p>
        <p style="width: calc(50% - 1.0rem)">
          {{input id=(concat currentModel.id '_armorClass') value=currentModel.armorClass type='number'}}
          <label for="{{currentModel.id}}_armorClass">Armor Class</label>
        </p>
      </div>
      <div class="column">
        <p>
          {{textarea id=(concat currentModel.id '_notes') value=currentModel.notes}}
          <label for="{{currentModel.id}}_notes">Notes</label>
        </p>
      </div>
    </div>
    <table id="attacks">
      <colgroup>
        <col>
        <col style="width: 12.0rem;">
        <col style="width: 12.0rem;">
        <col style="width: 32px;">
      </colgroup>
      <thead>
        <tr class="form inline">
          <th class="label em">
            Attacks
            <a href {{action (route-action 'addAttack')}} id="attacks_add" class="icon">{{icon 'add'}}</a>
          </th>
          <th class="label">{{icon (if currentModel.attacks.length 'bonus-attack' 'blank')}}</th>
          <th class="label">{{icon (if currentModel.attacks.length 'bonus-damage' 'blank')}}</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {{#unless currentModel.attacks.length}}
          <tr><td colspan="4" class="empty">No attacks added.</td></tr>
        {{/unless}}
        {{#each (reject-by 'isDeleted' true currentModel.attacks) as |attack|}}
          <tr class="form inline">
            <td class="em">
              <label>Name</label>
              {{input value=attack.name
                focus-out=(action (mut attack.name)) placeholder='–'}}
            </td>
            <td>
              <label>Attack Bonus</label>
              {{input value=attack.attackBonus type='number'
                focus-out=(action (mut attack.attackBonus)) placeholder='–'}}
            </td>
            <td>
              <label>Damage Bonus</label>
              {{input value=attack.damageBonus type='number'
                focus-out=(action (mut attack.damageBonus)) placeholder='–'}}
            </td>
            <td class="action">
              <a href {{action (route-action 'deleteAttack' attack)}} class="icon danger">{{icon 'delete'}}</a>
            </td>
          </tr>
        {{/each}}
      </tbody>
    </table>
  </form>
  {{#ember-wormhole to='modal'}}
    {{#x-modal class=(if showDeleteConfirmationModal 'shown' 'hidden')}}
      <form class="traditional modal">
        <p>
          <label class="wordy">Are you sure you want to delete this monster?</label>
        </p>
        <p class="actions">
          <button type="button" class="button subtle" {{action (toggle-action 'showDeleteConfirmationModal' this)}}>No</button>
          <button type="submit" class="button danger" {{action (route-action 'delete' currentModel)}}>Yes</button>
        </p>
      </form>
    {{/x-modal}}
  {{/ember-wormhole}}
{{/liquid-bind}}
